---
import { getImage } from 'astro:assets';
import servicesData from '../data/servicesDetail.json';
import Button from './Button.astro';
import ServicesCarouselClient from './ServicesCarouselClient';

// Import service images
import preventiveImg from '../assets/images/services/preventive.png';
import cosmeticImg from '../assets/images/services/cosmetic.png';
import restorativeImg from '../assets/images/services/restorative.png';
import emergencyImg from '../assets/images/services/emergency.png';
import familyImg from '../assets/images/services/family.png';
import orthodonticsImg from '../assets/images/services/orthodontics.png';

const serviceImagesRaw: Record<string, any> = {
  '/images/services/preventive.png': preventiveImg,
  '/images/services/cosmetic.png': cosmeticImg,
  '/images/services/restorative.png': restorativeImg,
  '/images/services/emergency.png': emergencyImg,
  '/images/services/family.png': familyImg,
  '/images/services/orthodontics.png': orthodonticsImg,
};

// Optimize images using getImage
const serviceImagesMap: Record<string, string> = {};
for (const [key, img] of Object.entries(serviceImagesRaw)) {
  const optimizedImage = await getImage({ src: img });
  serviceImagesMap[key] = optimizedImage.src;
}

interface Service {
  id: string;
  title: string;
  description: string;
  icon: string;
  image: string;
  items: string[];
}

const services: Service[] = servicesData;
---

<section class="py-16 bg-bg-main">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-10">
    <!-- Header -->
    <div class="mb-12 flex justify-between items-center">
      <h2 class="text-3xl md:text-4xl font-bold text-brand-deep" style="font-family: var(--font-family-display)">
        Our Services
      </h2>
      <Button variant="secondary" href="/services">
        All Services
      </Button>
    </div>

    <!-- Services carousel -->
    <ServicesCarouselClient services={services} serviceImages={serviceImagesMap} client:load />
  </div>
</section>
